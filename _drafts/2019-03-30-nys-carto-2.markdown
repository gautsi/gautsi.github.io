---
layout: post
title:  "NYS Counties Cartogram Part 2"
date:   2019-03-23
categories: post
---

In [part 1]({% post_url 2019-03-23-nys-carto %}), I talked about why I felt the following map doesn't accurately convey the results of the election:

<img src="/assets/nyt_nys_ag_dp_2018_map_033019.png" height="60%" width="60%" border="1">{: .center-image }

and showed this bar chart as an alternative that better shows the popular vote result but loses geographic relationships amongst the counties:

<div id="bar2" style="position:relative;" >
</div>

Researching other ways to represent geographic objects brought me to the concept of a cartogram. According to Wikipedia, a cartogram is a ...

There are many different ways to choose and organize the marks in a cartogram. Here is a paper that looks at various methods and compares by expressiveness and effectiveness of communicating geographic and other values...

For a cartogram of the election, the shape of a county didn't need preserving but rather its position in the state and relative to other counties. So perhaps we could first represent each county by a square, and then fill each square with representations of candidate vote totals in the county. All squares could be equal in size, so that no county occupies more space on the canvas than any other. But where do we place the county squares? The locations of the squares overall and relative to the other squares are how we will communicate the geographical structures in the data so we want to place them in geographically accurate positions.

One way we could place the squares is to center them on the centroids of the county shapes. The next sketch shows the counties, their centroids and squares centered at the centroids and lets you change the size of the squares. This seems like a reasonable way to place square, except that depending on the size of the square they overalap. Overlap is a problem for us because it can make easily see differences between properties of the county difficult. For the smallest square size of 5, there is no overlap but the squares are also prohibititively small to place other marks in. For larger square sizes like 20, there is overlap in various parts of the state, especially NYC.

How to remove overlap? The method I show here iterates through the marks, calculates overlaps and moves each mark away from overlapping squares and repeats until there is no more overlap left.




d3

<div id="button" style="position:relative;" ></div>
<div id="carto2" style="position:relative;" ></div>



<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

<script src="/sketches/carto/counties_bar2.js"></script>
<script src="/sketches/carto/update.js"></script>
<script src="/sketches/carto/carto_d3_static.js"></script>

### Notes

- votes are from [here](https://www.elections.ny.gov/2018ElectionResults.html)

### To do
- [x] print status on carto calc sketch
